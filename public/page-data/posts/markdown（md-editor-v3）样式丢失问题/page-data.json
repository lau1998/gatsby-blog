{"componentChunkName":"component---src-components-templates-blog-post-js","path":"/posts/markdownï¼ˆmd-editor-v3ï¼‰æ ·å¼ä¸¢å¤±é—®é¢˜/","result":{"data":{"markdownRemark":{"fields":{"slug":"posts/markdownï¼ˆmd-editor-v3ï¼‰æ ·å¼ä¸¢å¤±é—®é¢˜/"},"frontmatter":{"title":"markdownï¼ˆmd-editor-v3ï¼‰å¦‚ä½•åœ¨é¡µé¢æ˜¾ç¤ºï¼Œä»¥åŠæ ·å¼ä¸¢å¤±é—®é¢˜","description":"markdownï¼ˆmd-editor-v3ï¼‰å¦‚ä½•åœ¨é¡µé¢æ˜¾ç¤ºï¼Œä»¥åŠæ ·å¼ä¸¢å¤±é—®é¢˜çš„ä¸€ä¸ªè®°å½•ã€‚","date":"2022 å¹´ 03 æœˆ 21 æ—¥","thumbnail":null},"html":"<p>ä¹‹å‰åœ¨ä¸€ä¸ªVue3çš„é¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨åˆ°markdownå¯Œæ–‡æœ¬æ¡†ï¼Œäºæ˜¯ä¹å°±åœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹æ”¯æŒVue3çš„å¯Œæ–‡æœ¬æ¡†æ’ä»¶ï¼Œæœ€åæ„Ÿè§‰md-editor-v3å¾ˆä¸é”™ï¼Œè€Œä¸”è¿˜æ”¯æŒreactï¼Œäºæ˜¯ä¹å°±é€‰æ‹©å®ƒäº†ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ä»–çš„æ—¶å€™å‡ºç°äº†ä¸€äº›\"å°æ’æ›²\"ï¼Œæœ€ç»ˆå‡­æˆ‘æƒŠäººçš„æ¯…åŠ›ğŸ’ªï¼ŒèŠ±è´¹äº†3å¤©ğŸ˜©ï¼Œç»ˆäºèƒ½å‹å¥½çš„ä½¿ç”¨å®ƒäº†ğŸ¤‘ã€‚</p>\n<p>ä¸‹é¢å°±å°†è¿™äº›\"å°æ’æ›²\"è®°å½•ä¸‹æ¥ğŸ˜ã€‚</p>\n<p>é¦–å…ˆä»‹ç»ä¸€ä¸‹å®ƒæ€ä¹ˆä½¿ç”¨çš„ï¼š</p>\n<h3>åŠŸèƒ½</h3>\n<ol>\n<li>å¿«æ·æ’å…¥å†…å®¹å·¥å…·æ ã€ç¼–è¾‘å™¨æµè§ˆå™¨å…¨å±ã€é¡µé¢å†…å…¨å±ç­‰ï¼›</li>\n<li>å†…ç½®çš„ç™½è‰²ä¸»é¢˜å’Œæš—é»‘ä¸»é¢˜ï¼Œæ”¯æŒç»‘å®šåˆ‡æ¢ï¼›</li>\n<li>æ”¯æŒå¿«æ·é”®æ’å…¥å†…å®¹ï¼›</li>\n<li>æ”¯æŒä½¿ç”¨ prettier æ ¼å¼åŒ–å†…å®¹ï¼ˆä½¿ç”¨ CDN æ–¹å¼å¼•å…¥ï¼Œåªæ”¯æŒæ ¼å¼åŒ– md å†…å®¹ï¼Œå¯åœ¨ä»£ç å†…è®¾ç½®å…³é—­ï¼‰ï¼›</li>\n<li>æ”¯æŒå¤šè¯­è¨€ï¼Œæ”¯æŒè‡ªè¡Œæ‰©å±•è¯­è¨€ï¼›</li>\n<li>æ”¯æŒå¤åˆ¶ç²˜è´´ä¸Šä¼ å›¾ç‰‡ï¼Œå›¾ç‰‡è£å‰ªä¸Šä¼ ï¼›</li>\n<li>æ”¯æŒä»…é¢„è§ˆæ¨¡å¼ï¼ˆä¸æ˜¾ç¤ºç¼–è¾‘å™¨ï¼Œåªæ˜¾ç¤º md é¢„è§ˆå†…å®¹ï¼Œæ— é¢å¤–ç›‘å¬ï¼‰</li>\n<li>...</li>\n</ol>\n<h3>é¢„è§ˆä¾‹å›¾</h3>\n<p><img src=\"/assets/img/md-editor-v3.png\" alt=\"md-editor-v3\"></p>\n<h3>Demoç¤ºä¾‹ä»£ç </h3>\n<div class=\"gatsby-highlight\" data-language=\"vue\"><pre class=\"language-vue\"><code class=\"language-vue\">&lt;template&gt;\n    &lt;el-row :gutter=&quot;20&quot; style=&quot;margin-bottom: 10px&quot;&gt;\n        &lt;el-col :span=&quot;6&quot;&gt;\n            &lt;el-input v-model=&quot;inputTitle&quot; placeholder=&quot;æ–‡ç« æ ‡é¢˜&quot; /&gt;\n        &lt;/el-col&gt;\n        &lt;el-col :span=&quot;10&quot;&gt;\n            &lt;el-input v-model=&quot;inputIntroduce&quot; placeholder=&quot;æ–‡ç« ç®€ä»‹&quot; /&gt;\n        &lt;/el-col&gt;\n        &lt;el-col :span=&quot;6&quot;&gt;\n            &lt;el-input v-model=&quot;coverImg&quot; placeholder=&quot;å°é¢å›¾åœ°å€&quot;&gt;\n                &lt;template #prepend&gt;URL:&lt;/template&gt;\n            &lt;/el-input&gt;\n        &lt;/el-col&gt;\n        &lt;el-col :span=&quot;1&quot;&gt;\n            &lt;el-button type=&quot;primary&quot; :disabled=&quot;isNull&quot; @click=&quot;bindArticle&quot;&gt;&lt;i class=&quot;bi bi-send&quot;&gt;&lt;/i&gt;&amp;nbsp;å‘å¸ƒ&lt;/el-button&gt;\n        &lt;/el-col&gt;\n    &lt;/el-row&gt;\n    &lt;md-editor ref=&quot;editorRef&quot; v-model=&quot;valueText&quot; @onChange=&quot;updateMarkdown&quot; @onHtmlChanged=&quot;updateHtml&quot;\n        :toolbarsExclude=&quot;[&#39;github&#39;]&quot; @onUploadImg=&quot;onUploadImg&quot; @onSave=&quot;codeSave&quot; :footers=&quot;footers&quot;\n        placeholder=&quot;è¯·åœ¨è¿™é‡Œè¿›è¡Œç¼–è¾‘ï¼&quot;&gt;\n        &lt;template #defFooters&gt;\n            &lt;span&gt;å·¦è¾¹Tips&lt;/span&gt;\n            &lt;span&gt;å³è¾¹Tips&lt;/span&gt;\n        &lt;/template&gt;\n    &lt;/md-editor&gt;\n&lt;/template&gt;\n\n&lt;script lang=&quot;ts&quot; setup&gt;\nimport { ref, onMounted, computed } from &#39;vue&#39;\n// è‡ªé€‰ä»£ç é«˜äº®æ ·å¼\nimport MdEditor from &#39;md-editor-v3&#39;\nimport &#39;md-editor-v3/lib/style.css&#39;\nimport sanitizeHtml from &#39;sanitize-html&#39;\nimport { ElMessage } from &#39;element-plus&#39;\nimport { RequestUploadImg, RequestArticleConetnt } from &#39;@/api&#39;\nimport type { ExposeParam } from &#39;md-editor-v3&#39;\nimport { useUserStore } from &#39;@/stores/user&#39;\nconst editorRef = ref&lt;ExposeParam&gt;()\nconst footers: any = [&#39;markdownTotal&#39;, 0, &#39;=&#39;, 1, &#39;scrollSwitch&#39;]\nconst sanitize = (html: any) =&gt; sanitizeHtml(html) //:sanitize=&quot;sanitize&quot;å¼€å‘é˜¶æ®µ æš‚æ—¶å…³é—­\n\nonMounted(() =&gt; {\n    editorRef.value?.focus()\n})\nconst inputTitle = ref(&#39;&#39;) //æ–‡ç« æ ‡é¢˜\nconst inputIntroduce = ref(&#39;&#39;) // æ–‡ç« ç®€ä»‹\nconst coverImg = ref(&#39;&#39;) // å°é¢å›¾åœ°å€\n// ã€æ¥å£ã€‘æ¥å—ä¼ å‚å­—æ®µ\ninterface IProps {\n    text: string\n}\n// åˆå§‹åŒ–é»˜è®¤å‚æ•°\nconst props = withDefaults(defineProps&lt;IProps&gt;(), {\n    text: &#39;&#39;,\n})\nconst valueText: any = ref(props.text)\nlet mdStr = ref(&#39;&#39;)\nconst updateMarkdown = (md: string) =&gt; {\n    mdStr.value = md\n}\nlet htmlStr = ref(&#39;&#39;)\nconst updateHtml = (html: string) =&gt; {\n    htmlStr.value = html\n}\n// å›¾ç‰‡ä¸Šä¼ äº‹ä»¶\nconst imageFile: any = ref(&#39;&#39;) //ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶\nconst imageUrl = ref(&#39;&#39;) //å›¾ç‰‡é¢„è§ˆåœ°å€\n// submitFormä¸ºæäº¤è¡¨å•äº‹ä»¶\nconst onUploadImg = async (\n    rawFile: Array&lt;File&gt;,\n    callback: (urls: Array&lt;string&gt;) =&gt; void\n) =&gt; {\n    const rawFiles = rawFile[0]\n    const arr = [&#39;image/jpeg&#39;, &#39;image/png&#39;, &#39;image/jpg&#39;]\n    console.log(&#39;å›¾ç‰‡æ ¼å¼--&gt;&#39;, rawFiles.type)\n    // å›¾ç‰‡æ ¼å¼éªŒè¯\n    if (!arr.includes(rawFiles.type)) {\n        ElMessage({\n            message: &#39;ä¸Šä¼ å›¾ç‰‡æ ¼å¼ä¸æ­£ç¡®ï¼!&#39;,\n            type: &#39;error&#39;,\n        })\n        return false\n    }\n    // å›¾ç‰‡å¤§å°éªŒè¯\n    if (rawFiles.size / 1024 / 1024 &gt; 2) {\n        ElMessage({\n            message: &#39;ä¸Šä¼ å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡2M!&#39;,\n            type: &#39;error&#39;,\n        })\n        return false\n    }\n    // å›¾ç‰‡é¢„è§ˆ\n    //1. é€‰ä¸­çš„æœ¬åœ°å›¾ç‰‡è½¬æˆBase64ç¼–ç  èµ‹å€¼ç»™ imageUrl\n    //2. FileReader è¯»æ–‡ä»¶\n    imageUrl.value = URL.createObjectURL(rawFiles)\n    // ä¸Šä¼ å›¾ç‰‡\n    imageFile.value = rawFiles\n    const formData = new FormData()\n    let fileBackInfo = await RequestUploadImg(imageFile.value) // å•æ–‡ä»¶ä¸Šä¼ \n    if (fileBackInfo.resultCode === 1) {\n        formData.append(&#39;url&#39;, fileBackInfo.resultInfo) // ä¼ å›¾ç‰‡åœ°å€\n    } else if (fileBackInfo.resultCode === -1) {\n        ElMessage({\n            message: &#39;å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼&#39;,\n            type: &#39;error&#39;,\n        })\n        return false\n    }\n    callback([fileBackInfo.resultInfo])\n}\n// ä¿å­˜ä»£ç \nconst codeSave = (v: string): void =&gt; {\n    ElMessage.success(&#39;å·²ä¿å­˜&#39;)\n    localStorage.setItem(&#39;MdCodeSave&#39;, v)\n    localStorage.setItem(&#39;MdHtml&#39;, htmlStr.value)\n}\nonMounted(() =&gt; {\n    // æŒ‚è½½åè·å–ä¹‹å‰ä¿å­˜çš„æ•°æ®\n    if (localStorage.getItem(&#39;MdCodeSave&#39;)) {\n        valueText.value = localStorage.getItem(&#39;MdCodeSave&#39;)\n    }\n})\n&lt;/script&gt;\n\n&lt;style scoped&gt;\n.md-editor {\n    height: 735px;\n}\n&lt;/style&gt;</code></pre></div>\n<h3>æ•ˆæœå›¾</h3>\n<p><img src=\"/assets/img/md-editor-v3.png\" alt=\"md-editor-demoæ•ˆæœå›¾\"></p>\n<h3>é‡åˆ°çš„éš¾é¢˜</h3>\n<ol>\n<li>\n<p>å¦‚ä½•åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºmdè½¬æˆçš„htmlå†…å®¹å‘¢ï¼Ÿ</p>\n<p>ä½ éœ€è¦æ‹¿åˆ°è½¬æ¢æˆhtmlçš„æ•°æ®ï¼Œç„¶åå°†ä»–ç»‘å®šåˆ°v-htmlä¸­ã€‚</p>\n</li>\n<li>\n<p>æ ·å¼ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿ</p>\n<p>å°±æ˜¯åœ¨v-htmlå…ƒç´ ä¸Šæ·»åŠ ä¸€ä¸ªclass=\"md-editor\"çš„ç±»åå°±è¡Œï¼Œä½†æ˜¯è¿˜éœ€åœ¨jsé‡Œé¢å¯¼å…¥æ ·å¼</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">'md-editor-v3/lib/style.css'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">'@/assets/css/atom-one-dark.min.css'</span></code></pre></div>\n<p><img src=\"/assets/img/Snipaste_2020.01.01.png\" alt=\"ä»£ç \"></p>\n<p>ç„¶åï¼Œå°±å®Œç¾è§£å†³æ ·å¼ä¸¢å¤±é—®é¢˜å•¦ï¼</p>\n<p>å¥½äº†ï¼Œæ•£ä¼šğŸ˜</p>\n</li>\n</ol>","timeToRead":4}},"pageContext":{"slug":"posts/markdownï¼ˆmd-editor-v3ï¼‰æ ·å¼ä¸¢å¤±é—®é¢˜/","previousPost":{"fields":{"slug":"posts/é˜¶æ®µäºŒé¢è¯•é¢˜/"},"frontmatter":{"title":"é˜¶æ®µäºŒé¢è¯•é¢˜ã€‚"}},"nextPost":{"fields":{"slug":"posts/npmçš„å¸¸ç”¨å‘½ä»¤/"},"frontmatter":{"title":"Npmçš„å¸¸ç”¨å‘½ä»¤"}}}},"staticQueryHashes":["3344698684","3792814546"]}